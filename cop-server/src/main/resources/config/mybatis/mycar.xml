<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cop.mobi.mycar.service.dao.MyCarDao">


	<resultMap id="carBrandResult" type="com.cop.mobi.mycar.entity.CarBrand">
		<result property="id" column="id" />
		<result property="manufacturer" column="manufacturer" />
		<result property="brand" column="brand" />
		<result property="model" column="model" />
		<result property="engine" column="engine" />
	</resultMap>

	<resultMap id="myCarResult" type="com.cop.mobi.mycar.entity.MyCarPo">
		<result property="id" column="id" />
		<result property="uid" column="uid" />
		<result property="sid" column="sid" />
		<result property="bid" column="bid" />
	</resultMap>

	<resultMap id="routeResult" type="com.cop.mobi.mycar.entity.DriveRoutePo">
		<result property="id" column="id" />
		<result property="mcid" column="mcid" />
		<result property="route" column="route" />
		<result property="beginTime" column="beginTime" />
		<result property="endTime" column="endTime" />
		<result property="addTime" column="addTime" />
	</resultMap>


	<select id="getAllCarBrands" resultMap="carBrandResult">
		SELECT
		id, manufacturer,
		brand, model,
		engine
		FROM
		LC_CarBrand
	</select>

	<select id="getMyCarById" resultMap="myCarResult">
		SELECT
		id, uid, sid, bid
		FROM
		LC_MyCar
		WHERE id=#{id}
	</select>

	<select id="getMyCarBySid" resultMap="myCarResult">
		SELECT
		id, uid, sid, bid
		FROM
		LC_MyCar
		WHERE sid=#{sid}
	</select>

	<select id="getMyCarsByUid" resultMap="myCarResult">
		SELECT
		id, uid, sid, bid
		FROM
		LC_MyCar
		WHERE uid=#{uid}
	</select>

	<insert id="addMyCar" parameterType="com.cop.mobi.mycar.entity.MyCar">
		INSERT INTO LC_MyCar
		(uid,
		sid, bid)
		VALUES
		(#{uid}, #{sid}, #{bid})
	</insert>

	<update id="updateMyCarInfo">
		UPDATE LC_MyCar 
		SET 
		bid=#{bid}
		WHERE id=#{id}
	</update>

	<delete id="deleteMyCar">
		DELTE FROM LC_MyCar
		WHERE id=#{mcid}
	</delete>

	<update id="freezeMyCar">
		UPDATE LC_MyCar SET freeze=0 WHERE id=#{mcid}
	</update>

	<select id="getDriveRoutes" resultMap="routeResult">
		SELECT
		id, mcid, route, beginTime, endTime, addTime
		FROM
		LC_DriveRoute
		WHERE mcid=#{mcid}
		AND
		<![CDATA[
		beginTime>=#{beginTime} AND endTime<=#{endTime}
		]]>
	</select>

</mapper>